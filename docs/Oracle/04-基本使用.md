# 基本使用

## sqlplus


```sh
sqlplus [ [<option>] [{logon | /nolog}] [<start>] ]
```

* option

    ```sh
    <option>: [-C <version>] [-L] [-M "<options>"] [-R <level>] [-S]

    # -C version: 如果有受版本影响的命令, 使用-c执行版本(version), 格式: "x.y[.z]", e.g."10.2.0"
    # -L : 仅登录一次
    # -M : 设置输出HTML格式 "HTML [ON|OFF] [HEAD text] [BODY text] [TABLE text] [ENTMAP {ON|OFF}] [SPOOL {ON|OFF}] [PRE[FORMAT] {ON|OFF}]"
    # -R : 设置级别, 以限制 SQL*Plus 命令与文件系统的交互. 可选级别: 1,2,3; "-R 3" 表示禁用用所有与文件系统交互的用户命令
    # -S : 设置不显示 SQL*Plus 横幅、提示和命令回显的静默模式

* logon, /nolog

    ```sh
    <logon> : {<username>[/<password>][@<connect_identifier>] | / } [AS {SYSDBA | SYSOPER | SYSASM}] [EDITION=value]
    
    # 指定数据库连接的数据库帐户用户名(username)、密码(password)和连接标识符(connect_identifier)。 如果没有连接标识符，SQL*Plus 将连接到默认数据库($ORACEL_SID)。
    # connect_identifier : [<net_service_name> | [//]Host[:Port]/<service_name>]
    #     net_service_name: is a simple name for a service that resolves to a connect descriptor.
    #     Host: specifies the host name or IP address of the databaseserver computer.
    #     Port: specifies the listening port on the database server
    #     service_name: specifies the service name of the database you want to access.
    #     e.g.
              sqlplus myusername/mypassword@ORCL       # net_service_name
              sqlplus myusername/mypassword@Host/ORCL  # 
    # EDITION: specifies the value for Session Edition.
    ```

    ```sh
    </nolog>  # start SQL*Plus without connecting to a database.
    ```

* start

    ```sh
    <start> : @<URL>|<filename>[.<ext>] [<parameter> ...]

    # Runs the specified SQL*Plus script from a web server (URL) or the
    # local file system (filename.ext) with specified parameters that
    # will be assigned to substitution variables in the script.
    ```

> When **SQL\*Plus** starts, and after `CONNECT` commands, **the site profile** (e.g. `$ORACLE_HOME/sqlplus/admin/glogin.sql`) and **the user profile** (e.g. `login.sql` in the working directory) are run.  The files may contain SQL*Plus commands.


```sh
sqlplus [username]/[password] as <role>
sqlplus / as sysdba
```


## 解锁scott用户

    ```sql
    ~]$ sqlplus / as sysdba
    SQL> alter user scott identified by tiger account unlock;
    SQL> conn scott/tiger
    Connected.
    SQL> select * from tab;

    TNAME                          TABTYPE  CLUSTERID
    ------------------------------ ------- ----------
    BONUS                          TABLE
    DEPT                           TABLE
    EMP                            TABLE
    SALGRADE                       TABLE
    ```

## 设置显示

* 设置行长度：

    ```sql
    SQL> set linesize 120;
    ```

* 设置参数显示长度：

    ```sql
    SQL> column parameter for a50;
    ```

## 关于netca

Network Configuration assistan

* Listener Configuration
* Naming Method Configuration
* Local Net Service Name Configuration
* Directory Usage Configuration
  


```sh
$ORACLE_HOME/network/admin]$ cat tnsnames.ora 
# tnsnames.ora Network Configuration File: /u01/app/oracle/product/11.2.0/dbhome_1/network/admin/tnsnames.ora
# Generated by Oracle configuration tools.

ORCL =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.161.8)(PORT = 1521))
    )
    (CONNECT_DATA =
      (SERVICE_NAME = orcl)
    )
  )
```

### sqlnet.ora

* `netca`中 "Naming Method Configuration" 可以配置
* 1.通过这个文件来决定怎么样找一个连接中出现的连接字符串
* 2.确定认证方式( `SQLNET.AUTHENTICATION_SERVICES= (NONE,NTS)`)

```sh
$ORACLE_HOME/network/admin]$ cat sqlnet.ora 
# sqlnet.ora Network Configuration File: /u01/app/oracle/product/11.2.0/dbhome_1/network/admin/sqlnet.ora
# Generated by Oracle configuration tools.

NAMES.DIRECTORY_PATH= (TNSNAMES,HOSTNAME,EZCONNECT)

ADR_BASE = /u01/app/oracle
```

如果配置文件如上，则执行 `sqlplus sys/oracle@ora` 时，客户端就会首先在 `tnsnames.ora` 文件中找 ora 的记录，如果没有相应的记录则尝试把ora当作一个主机名，通过网络的途径去解析它的 ip地址, 然后去连接这个ip上 `GLOBAL_DBNAME=ora` 这个实例。


### listener.ora 

```sh
$ORACLE_HOME/network/admin]$ cat listener.ora 
# listener.ora Network Configuration File: /u01/app/oracle/product/11.2.0/dbhome_1/network/admin/listener.ora
# Generated by Oracle configuration tools.

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = ora11g-node01)(PORT = 1521))
    )
  )

ADR_BASE_LISTENER = /u01/app/oracle
```


